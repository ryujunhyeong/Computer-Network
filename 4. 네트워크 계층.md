# 네트워크 계층 서비스

## 역할
> 패킷화
```
1. 발신지에서는 상위 계층에서 받은 데이터인 페이로드를 네트워크 계층의 패킷으로 캡슐화 함
2. 목적지에서는 네트워크 계층의 패킷을 역 캡슐화 함  
```
> 라우팅
```
1. 네트워크 계층은 패킷이 발신지에서 목적지까지 갈 수 있도록 경오를 라우팅 함
```
> 포워딩
```
1. 라우터 상의 하나의 인터페이스로 패킷이 도착했을 때 라우터가 취하는 행동
2. 이때 사용하는 의사결정 테이블을 포워딩 테이블, 라우팅 테이블 이라 부르기도 함
```
> 오류제어
```
1. 네트워크 계층에서 구현될 수 있지만 인터넷 네트워크 계층을 설계할 때 네트워크 계층이 오류 제어를 고려하지는 않았음
2. 각 라우터에서 패킷이 단편화 될 때 마다 네트워크 계층에서 오류를 검사하는 것은 비효율적이라 생각했기 때문
3. 다만, 헤더 훼손 방지를 위한 검사합 필드(checksum)는 추가했음
4. 오류 제어 할 수 있는 ICMP 프로토콜 제공
```
> 흐름 제어
```
1. 흐름 제어는 수신자가 허용할 수 있을 만큼의 데이터만 보내도록 조절 하는 것임
2. 네트워크 계층은 직접적인 흐름 제어를 제공하지 않음
3. 상위 계층에서 흐름제어를 진행 하고, 네트워크 계층에서 흐름 제어를 진행시 구조가 복잡해지고 비효율적이어 지기 때문
```
> 혼잡 제어
```
1. 인터넷 공간에 너무 많은 데이터그램이 존재하는 경우
2. 송신자가 보낸 데이터그램이 네트워크나 라우터의 처리 성능을 초과한 경우 발생
3. 데이터그램을 처리하지 못할수록 상위 계층의 오류 제어로 인해 손실된 패킷의 복사본을 계속 보내어 상황을 더욱 악화시킬 수 있음
4. 현재 인터넷에는 구현되어 있지 않음
```
> 서비스 품질
```
1. 인터넷은 멀티미디어 통신과 같은 어플리케이션을 지원하기 위해 보다 나은 서비스 품질을 제공하며 발전했음
2. 그러나, 네트워크 계층을 그대로 두기 위해 이런 기능들의 대부분은 상위 계층에 구현되어야 함
```
> 보안
```
1. 과거 인터넷을 설계할 당시 연구 목적으로 설계하였기 때문에 보안은 고려 대상이 아니었음
2. 비연결형 네트워크 계층에 보안성을 제공하기 위해 연결 지향형 서비스로 변경할 수 있는 IPSEC이라는 가상의 단계가 필요함
```
## 패킷 교환
##### 패킷 교환 네트워크의 연결 장치는 패킷을 최종 목적지로 어떻게 보낼지를 결정함
##### 오늘날 패킷 교환 네트워크에서 패킷의 경오를 찾기위해 데이터그램 방식, 가상 회선 방식을 사용함
> 데이터그램 방식: 비연결형 서비스
```
1. 인터넷이 처음 만들어 질 때 네트워크 계층을 간소화를 위해 모든 패킷을 독립적으로 처리하는 비연결형 서비스로 설계함
2. 각 패킷은 헤더에 포함된 발신지 주소와 목적지 주소를 기반으로 라우팅 됨
3. 라우터는 목적지 주소만 참조하여 경로를 라우팅 함
4. 발신지 주소는 패킷이 폐기될 때 오류 메시지를 전송하기 위해 사용함
5. 한 메시지에 속한 패킷도 연관성이 없음
```

> 가상 회선 방식
```
1. 가상 회선 방식에서 포워딩은 패킷의 레이블에 의해 결정됨
2. 한 메시지에 속한 모든 패킷은 연관성이 있음
3. 발신지와 목적지 주소 뿐만이 아니라 패킷이 지나가는 가상 경로를 정의하는 가상 회선 인식자와 같은 흐름 레이블을 포함함
4. 흐름 레이블 사용으로 발신지와 목적지가 불필요 하게 생각될 수 있지만, 네트워크 계층에서 여전히 비연결형 서비스를 사용하고
   있을 수 있으므로 이 주소들이 필요함
```
## 네트워크 계층 성능
##### 네트워크의 성능은 지연, 처리량, 패킷 손실률로 층정 가능하다
### 지연
###### 대부분 네트워크가 즉각 반을하길 원하지만 패킷이 발신지에서 목적지까지 전송될 때 필연적으로 지연이 발생함
> 전송 지연
```
1. 송신자는 전송해야 할 패킷에 하나하나 비트 정보들을 추가해야함으로 패킷을 즉시 보낼 수 없음
2. 전송해야 할 패킷에 첫 번째 비트가 t1에 추가되고 마지막 비트에 t2를 추가하면 전송 지연은 (t2-t1)이 됨
3. 큰 패킷의 길이가 길수록 전송 지연도 길어지며, 빨리 보낼 수 있으면 짧아짐
```
```
Delay(tr) = (Packet length)/(Transmission rate)
```
